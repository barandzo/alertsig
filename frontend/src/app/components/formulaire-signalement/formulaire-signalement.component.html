<div class="overlay" (click)="fermerModal()">
  <div class="modal" (click)="$event.stopPropagation()">

    <div class="modal-header">
      <h2 class="modal-title">Signaler un incident</h2>
      <button class="close-btn" (click)="fermerModal()">‚úï</button>
    </div>

    <div class="modal-body">

      <!-- Succ√®s -->
      <div class="success-msg" *ngIf="success">
        ‚úÖ Signalement envoy√© avec succ√®s !
      </div>

      <!-- Erreur -->
      <div class="error-msg" *ngIf="error">
        ‚ö†Ô∏è {{ error }}
      </div>

      <!-- Type d'incident -->
      <div class="form-group">
        <label class="form-label">Type d'incident</label>
        <div class="type-grid">
          <div
            *ngFor="let type of types"
            class="type-option"
            [class.selected]="selectedTypeId === type.id"
            (click)="selectedTypeId = type.id">
            <div class="type-emoji">{{ type.emoji }}</div>
            <div class="type-label">{{ type.libelle }}</div>
          </div>
        </div>
      </div>

      <!-- S√©v√©rit√© -->
      <div class="form-group">
        <label class="form-label">S√©v√©rit√©</label>
        <div class="severite-btns">
          <button
            class="sev-btn"
            [class.active-faible]="selectedSeverite === 1"
            (click)="selectSeverite(1)">
            üü° Faible
          </button>
          <button
            class="sev-btn"
            [class.active-moyen]="selectedSeverite === 2"
            (click)="selectSeverite(2)">
            üü† Mod√©r√©
          </button>
          <button
            class="sev-btn"
            [class.active-critique]="selectedSeverite === 3"
            (click)="selectSeverite(3)">
            üî¥ Critique
          </button>
        </div>
      </div>

      <!-- Description -->
      <div class="form-group">
        <label class="form-label">Description</label>
        <textarea
          class="form-input"
          [(ngModel)]="description"
          placeholder="D√©crivez l'incident...">
        </textarea>
      </div>

      <!-- Position GPS -->
      <div class="form-group">
        <label class="form-label">Position GPS</label>
        <div class="location-box">
          <span class="location-dot" [class.loading]="localisationEnCours"></span>
          <span *ngIf="localisationEnCours">Localisation en cours...</span>
          <span *ngIf="!localisationEnCours && latitude">
            {{ latitude!.toFixed(5) }}, {{ longitude!.toFixed(5) }}
          </span>
        </div>
      </div>

    </div>

    <div class="modal-footer">
      <button class="btn-cancel" (click)="fermerModal()">Annuler</button>
      <button
        class="btn-submit"
        (click)="soumettre()"
        [disabled]="loading || localisationEnCours">
        {{ loading ? 'Envoi...' : 'üì° Envoyer' }}
      </button>
    </div>

  </div>
</div>